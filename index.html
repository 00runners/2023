<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <!-- fonts -->
    <link rel="stylesheet" href="src/styles.css">
    <link rel="fonts" href="src/fonts.css">

<title>00runners (Work In Progress)</title>
</head>
<body>
    <div id="navBar"></div>

    <br><br>

    <div class="container">
        <div class="sketchBox">최근 러닝 세션 사진&정보</div>
        <div class="sketchBox" style="padding: 40px;">다음 세션 소개</div>
            <div style="color: grey">
            <br><h3>아래로는 멤버 랭크</h3>
            * collapsed 에서 보여지는 것: 순위, 이름, Role, 인스타그램 id, 마라톤<br>
            * opended 에서 보여지는 것: 러닝 로그, bio(TBD)
            </div>
            <br>
            


            <div id="memberRank">

            <details class="memberStrip">
                <summary>
                  <div class="row">
                    <div class="col-2 rankDiv">
                       #1
                    </div>
                    <div class="col-5 nameDiv">
                      <p class="nameField"><b>박종한</b></p>
                      <small class="instagramIdDiv">@jonghan_future</small>
                    </div>
                    <div class="col-3">
                      <mark class="label"><i>HQ</i></mark>
                    </div>
                    <div class="col-2 marathonDiv">
                     <b>10K</b>
                    </div>
                  </div>
                </summary>

                <hr style="color: red; height: 2px;">
                <div markdown="1">
                
                <div class="row logContents">
                  <div class="col-3">
                    3월
                  </div>
                  <div class="col-6">
                    옥수 정규런
                  </div>
                  <div class="col-3">
                    +5K
                  </div>
                </div>

                <div class="row logContents">
                  <div class="col-3">
                    3월
                  </div>
                  <div class="col-6">
                    옥수 정규런
                  </div>
                  <div class="col-3">
                    +5K
                  </div>
                </div>

                <div class="instagramSection">
                  instagram: @jonghan_future
                </div>

                </div>
                </details>


               </div>

            <br><br><br>
            

    </div>
    


    <script type="module">
      //  데이터를 두 파일로 나눠놓은 이유: 업데이트의 용이함.
      // log 파일의 구조를 짠 기준: 데이터 업데이트의 편리함.
      // uid 기준으로 불러와서 정렬하는 로직을 짜야 함. 
      // 마라톤 합산해서 show라는 이름의 array에 넣고, sort

        import c from "/src/component.js";
        import u from "/src/user.js";
        import l from "/src/log.js";

        console.log(u[0]['uid']);
        console.log(u[0]['badge'][0]);
        console.log(u);

        // **** mSum 산출 ****
        let mSum = l.reduce(function(acc, item) {
          if (!acc[item.uid]) {
            acc[item.uid] = 0;
          }
          acc[item.uid] += item.marathon;
          return acc;
        }, {});
        console.log(mSum);

        // **** mSum 순서대로 정렬 ****
        const rank = Object.keys(mSum).map(function(key) {
          return {uid: key, marathon: mSum[key]};
        });
        rank.sort(function(a, b) {
          return b.value - a.value;
        });
        console.log(rank);

        console.log(u[rank[0]['uid']]['badge']);
        console.log(rank[0]['marathon']);


        document.getElementById("navBar").insertAdjacentHTML("beforeEnd", c['navBar']);
        document.getElementById("memberRank").insertAdjacentHTML("beforeEnd",
        `<details class="memberStrip">
                <summary>
                  <div class="row">
                    <div class="col-2 rankDiv">
                       #1
                    </div>
                    <div class="col-5 nameDiv">
                      <p class="nameField"><b>박종한</b></p>
                      <small class="instagramIdDiv">@jonghan_future</small>
                    </div>
                    <div class="col-3">
                      <mark class="label"><i>HQ</i></mark>
                    </div>
                    <div class="col-2 marathonDiv">
                     <b>10K</b>
                    </div>
                  </div>
                </summary>

                <hr style="color: red; height: 2px;">
                <div markdown="1">
                
                <div class="row logContents">
                  <div class="col-3">
                    3월
                  </div>
                  <div class="col-6">
                    옥수 정규런
                  </div>
                  <div class="col-3">
                    +5K
                  </div>
                </div>

                <div class="row logContents">
                  <div class="col-3">
                    3월
                  </div>
                  <div class="col-6">
                    옥수 정규런
                  </div>
                  <div class="col-3">
                    +5K
                  </div>
                </div>

                <div class="instagramSection">
                  instagram: @jonghan_future
                </div>

                </div>
                </details>`

                );


        </script>

</body>
</html>